# Радио модуль для контроля за утечками

Модуль представляет собой плату основанную на микроконтроллере STM32F030F4P6 и радио модуле NRF24L01.
Логика работы модуля по умолчанию следующая:
1. Глубокий сон в течении одной минуты;
2. Опрос датчика влажности;
3. В случае превышения порогово значения отправка сообщения через NRF24L01;

## Общая схема датчика
Сам проект радио датчика лежит на EasyEDA  https://easyeda.com/leech001/leakcontrol
![shema]()

![pcb]()

## Описание программного обеспечения

Доступен исходный код проекта основанный на библиотеке HAL.
Сам проект сгенерирован в STM32CubeMX.

Настройка индентификатора трубы
```
const uint64_t pipe1 = 0xF0F0F0F0A1LL;
```
Сброс флага сна
```
__HAL_PWR_CLEAR_FLAG(PWR_FLAG_WU);
```
Настройка порога срабатывания датчика
```
if (adc > 200) {
```
Инициализация радиомодуля, установка скорости, установка канала и открытия трубы на передачу.
```
NRF_Init();
setDataRate(RF24_250KBPS);
setChannel(76);
openWritingPipe(pipe1);
```

Для тех кто не силен доступен готовый бинарник который нужно просто зашить в МК.